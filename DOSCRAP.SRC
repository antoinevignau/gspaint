;======================================================;;                                                      ;;              D O S C R A P                           ;;                                                      ;;======================================================;DoScrap        Start               Using AllEqu               Using Data               Using CursPat               Using Cursor               Using Strings;------------------------------------------------------;;              ScrapToMy;; Convertit le Scrap public en Scrap PriveScrapToMy      Entry               Pha                      OutPut               Pha               PushLong #$100                          PushWord MyId               PushWord #%0000000000011000     Non Locke               PushLong #0               _NewHandle               Bcc  OkMM1               Brk  $ABOkMM1          Anop               Lda  1,s               Sta  Ptr10               Sta  hPicture               Lda  3,s               Sta  Ptr10+2               Sta  hPicture+2               Pea  1                   Picture               _GetScrap               Bcc  PicScrap               PushLong Ptr10               Pea  0                   Texte               _GetScrap               Jcs  NoScrap               Brl  TextScrap PicScrap       Anop               PushLong Ptr10               _HLock               Lda  [Ptr10]               Sta  Ptr14               Ldy  #2               Lda  [Ptr10],y               Sta  Ptr14+2               Ldy  #4               Lda  [Ptr14],y               Sta  DragRect               Ldy  #6               Lda  [Ptr14],y               Sta  DragRect+2               Ldy  #8               Lda  [Ptr14],y               Sta  DragRect+4               Ldy  #10               Lda  [Ptr14],y               Sta  DragRect+6               PushLong Ptr10               _HUnlock               PushPtr Util_Port               _OpenPort               MoveLong PtrSelect,CurPtrSelect               PushPtr Select_Li               _SetPortLoc               MoveLong PtrSelect,Ptr18               Ldy  #(Paintx*Painty/2)-2               Lda  #$FFFFLoopStz1       Anop               Sta  [Ptr18],y               Dey               Dey               Bpl  LoopStz1               PushLong hPicture               PushzPtr DragRect               _DrawPicture;              Brk  2               PushPtr Util_Port               _ClosePort               PushLong PaintPort               _SetPort               PushLong hPicture               _DisposeHandle               Pha                      Pour limiter la Taille de la Select               PushZPtr DragRect               PushPtr BufferRect               PushZPtr DragRect               _SectRect               Pla               Lda  #TypeSelect               Sta  TopSelect               Lda  #CopyId               Sta  ItemId               Jsr  CutCopy             Passe la selection dans mon buffer               Stz  TopSelect                      RtsTextScrap      Anop               PushLong Ptr10               _HLock               Lda  [Ptr10]               Sta  Ptr14               Ldy  #2               Lda  [Ptr10],y               Sta  Ptr14+2               PushPtr Util_Port               _OpenPort               MoveLong PtrSelect,CurPtrSelect               PushPtr Select_Li               _SetPortLoc               Pea  0               Pea  8                   Font system 9 de Haut               RtsNoScrap        Anop               PushLong hPicture               _DisposeHandle               Rts             ;------------------------------------------------------;;              MyToScrap;; Convertit le Scrap Prive en Scrap publicMyToScrap      Entry               Lda  TopSomePaste               Bne  *+3               Rts               _ZeroScrap               Pha               _GetScrapCount               Pla               Sta  ScrapCount               Lda  MyScrapy               Sta  PicFrame+4               Lda  MyScrapx               Sta  PicFrame+6               PushPtr Util_Port               _OpenPort               MoveLong CurPtrSelect,PtrScrap               PushPtr Scrap_Li               _SetPortLoc               Pha               Pha               PushPtr PicFrame               _OpenPicture               Pla               Sta  hPicture               Pla               Sta  hPicture+2               PushPtr PPParms               _PaintPixels               _ClosePicture               PushPtr Util_Port               _ClosePort               PushLong PaintPort               _SetPort               PushLong hPicture               _HLock               Pha               Pha               PushLong hPicture               _GetHandleSize               Pea  1                   Type Picture               MoveLong hPicture,Ptr10               Ldy  #2               Lda  [Ptr10],y               Pha               Lda  [Ptr10]               Pha               _PutScrap               PushLong hPicture               _HUnlock               PushLong hPicture               _DisposeHandle               _UnLoadScrap               Rts;------------------------------------------------------ ;;              Data;BufferRect     dc   i'0,0,Painty,Paintx'hPicture       ds   4Scrap_Li       dc   i'0'PtrScrap       ds   4               dc   i'Paintx/2'PicFrame       dc   i'0,0'               ds   4PPParms        Anop               dc   i4'Util_Port'               dc   i4'Util_Port'               dc   i4'PicFrame'               dc   i4'PicFrame'               dc   i'PenCopy'               dc   i4'0'               End